<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <title>05 - Créer et ajouter des objets dans un tableau continuellement</title>
    <style type="text/css">
        canvas {
            background-image: url(images/fondMarin.png);
            border: 1px solid black;
        }

    </style>
</head>

<body>
    <!-- Créer la balise canvas et définir ses dimensions -->
    <canvas width="800" height="600"> </canvas>

    <script>
        //Récupérer le canvas
        let leCanvas = document.querySelector("canvas");
        let ctx = leCanvas.getContext("2d");


        //tableau pour mémoriser les meduses (image, position X et Y, etc.)
        let lesMeduses = [];


        //Affichage des objets animés selon une cadence de 60 ips 
        setInterval(actualiserJeu, 1000 / 12);

        //Création d'une méduse à chaque seconde en appelant la fonction ajouterUneMeduse
        setInterval(ajouterUneMeduse, 1000);

        ////////////////////////// Les fonctions /////////////////////////////////
        function ajouterUneMeduse(){
            let uneMeduse = {
            img: new Image(),
            posX: Math.ceil(Math.random() * (leCanvas.width - 90)),
            posY: Math.ceil(Math.random() * (leCanvas.height - 200)),
            largeur: Math.ceil(Math.random() * 90 ) + 20, //largeur 20 pix minimum
            hauteur: Math.ceil(Math.random() * 98 ) + 20, //hauteur 20 pix minimum
        }
            //Charger l'image de meduse
            uneMeduse.img.src = "images/meduse.png";

            //Ajouter chaque méduse dans le tableau des méduses, pour permettre de les dessiner 
            lesMeduses.push(uneMeduse);
        }



        ////////////////////////// Les fonctions /////////////////////////////////

        //Fonction qui créé UNE SEULE méduse et l'ajoute dans le tableau des méduses 

        
        
        //Fonction pour actualiser l'affichage du canvas
        function actualiserJeu() {
            //Effacer le canvas
            ctx.clearRect(0, 0, leCanvas.width, leCanvas.height);

            //Dessiner les qui se trouve dans le tableau
            dessinerLesMeduses();

        }

        //Dessiner chaque méduse qui se trouve dans le tableau des mesuses 
        function dessinerLesMeduses() {

            //parcourir le tableau avec une boucle for... of
            //qui permet de sélectionner chaque méduse et le dessine
            for (let uneMeduse of lesMeduses) {

                //Chaque méduse est dessinée à sa taille différente
                ctx.drawImage(uneMeduse.img, uneMeduse.posX, uneMeduse.posY, uneMeduse.largeur, uneMeduse.hauteur);

                //déplacement aléatoire en X, pour créer un petit mouvement
                for(i of lesMeduses){
                ctx.drawImage(i.img,i.posX,i.posY,i.largeur,i.hauteur);

                i.posX += (Math.random()-.5);
            }

            }
        }

    </script>

</body>

</html>
